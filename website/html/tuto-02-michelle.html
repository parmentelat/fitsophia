<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Tutorial - First steps</title>
      <link rel="icon" type="image/png" href="assets/img/r2lab-icon.png"/>

    <link type="text/css" rel="stylesheet" href="assets/css/bootstrap.min.css"/>
    <link type="text/css" rel="stylesheet" href="assets/css/pilcrow.css"/>
    <link type="text/css" rel="stylesheet" href="assets/css/hljs-github.min.css"/>
    <!-- adding jquery to the mix -->
    <script type="text/javascript" src="assets/js/jquery-2.1.4.min.js"></script>
    <!-- our script for setting the active tabs right -->
    <script type="text/javascript" src="assets/js/active-tab.js"></script>
    <!-- extra space for navbar-fixed-top -->
    <style type="text/css">
      body { padding-top: 70px; }
    </style>
  </head>
<body>

  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          <img alt="logo" style="height:18px;" src="assets/img/r2lab-logo.png" />
        </a>
      </div>

      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
          <li id="tab-overview"  tab="tutorials"><a href="overview.html">Overview</a></li>
          <li class="dropdown" id="tab-tutorials" tab="tutorials">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="tuto-01-registration.html#">Registration</a></li>
              <li><a href="tuto-02-michelle.html">Michelle's</a></li>
            </ul>
          </li>
          <li id="tab-status" tab="tutorials"><a href="status.html">Status</a></li>
          <li id="tab-events" tab="tutorials"><a href="events.html">Events</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="http://portal.onelab.eu" target="_blank">
              <img src="assets/img/onelab-logo.png" style="height:18px;"> FIT Portal
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="jumbotron" style="background:url(assets/img/back.jpg)no-repeat; background-size:100%; height:310px ;">
  </div>

  <div class="container">
    <div class="page-header">
      <h1>Tutorial - First steps </h1>
    </div><h1 id="pre-requisite"><a class="header-link" href="#pre-requisite"></a>Pre-requisite</h1>
<p>Obtain a slice account on R2LAB (faraday)</p>
<h1 id="direct-ssh-access-to-the-node"><a class="header-link" href="#direct-ssh-access-to-the-node"></a>Direct ssh access to the node</h1>
<p>Example IP addresses of the target node</p>
<ul class="list">
<li>CM card interface : 192.168.1.25</li>
<li>Experiment interface : 192.168.2.25</li>
<li>Control interface (OMF) : 192.168.3.25</li>
</ul>
<p><strong>1 - Connect to your account in faraday</strong></p>
<pre class="hljs"><code>$ ssh my-account@faraday<span class="hljs-class">.inria</span><span class="hljs-class">.fr</span></code></pre><p><strong>2 - Check access and IP address through the CM card</strong></p>
<pre class="hljs"><code><span class="hljs-variable">$ </span>curl <span class="hljs-number">192.168</span>.<span class="hljs-number">1.25</span>/status
<span class="hljs-variable">$ </span>curl <span class="hljs-number">192.168</span>.<span class="hljs-number">1.25</span>/info</code></pre><p><strong>3 - Try to start and stop the node</strong></p>
<pre class="hljs"><code>$ curl <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.25</span>/<span class="hljs-function_start"><span class="hljs-keyword">on</span></span>[|off|reset]</code></pre><p><strong>4 - Get the status of the node through OMF</strong></p>
<pre class="hljs"><code>$ omf6 <span class="hljs-built_in">stat</span> -t fit25 </code></pre><p><strong>5 - Start the node through OMF</strong></p>
<pre class="hljs"><code>$ omf6 <span class="hljs-keyword">tell</span> -t fit25 -a <span class="hljs-function_start"><span class="hljs-keyword">on</span></span>|off|reset</code></pre><p><strong>6 - Ping the control interface to check that the node received its IP address</strong></p>
<pre class="hljs"><code>$ <span class="hljs-built_in">ping</span> <span class="hljs-number">192.168</span><span class="hljs-number">.3</span><span class="hljs-number">.25</span></code></pre><p><strong>7 - Load the baseline image</strong></p>
<pre class="hljs"><code>$ omf6 load -t fit25 [-<span class="hljs-tag">i</span> baseline.ndz]</code></pre><p>The node starts with the PXE image, gets an IP address, downloads the baseline image and restarts, as instructed in <code>.omf/etc/omf_script_conf.yaml</code>.<br>This can be monitored through <code>/var/log/upstart/ntrc_frisbee.log</code>.<br>The PXE image is located in <code>/tftpboot</code>.<br>The baseline image <code>baseline.ndz</code> is located in <code>/var/lib/omf-images-6</code>.   </p>
<p><strong>8 - Access the node through ssh (as root)</strong></p>
<pre class="hljs"><code><span class="hljs-variable">$ </span>ssh fit25</code></pre><p><strong>9 - Save the modified image</strong></p>
<pre class="hljs"><code>$ omf6 <span class="hljs-keyword">save</span> -<span class="hljs-keyword">n</span> fit25</code></pre><h1 id="using-short-commands-through-ssh"><a class="header-link" href="#using-short-commands-through-ssh"></a>Using short commands through ssh</h1>
<p><strong>1 - Connect to your account in faraday</strong></p>
<pre class="hljs"><code>$ ssh my-account@faraday<span class="hljs-class">.inria</span><span class="hljs-class">.fr</span></code></pre><p><strong>2 - Select the nodes you want to use</strong></p>
<ul class="list">
<li><p>All available nodes</p>
<pre class="hljs"><code>  <span class="hljs-variable">$ </span>all-nodes</code></pre></li>
<li><p>A discontinuous set of nodes (e.g., fit15 and fit25)</p>
<pre class="hljs"><code>  <span class="hljs-variable">$ </span>nodes <span class="hljs-number">15</span> <span class="hljs-number">25</span></code></pre></li>
<li><p>A continuous set of nodes (e.g., fit30 to fit32)</p>
<pre class="hljs"><code>  <span class="hljs-variable">$ </span>nodes <span class="hljs-number">30</span>-<span class="hljs-number">32</span></code></pre></li>
<li><p>All nodes currently turned on</p>
<pre class="hljs"><code>  $ focus-nodes-<span class="hljs-function_start"><span class="hljs-keyword">on</span></span></code></pre></li>
<li><p>Add / remove a node from the existing list (e.g., fit20)</p>
<pre class="hljs"><code>  $ <span class="hljs-keyword">n</span>+ 20 [<span class="hljs-keyword">n</span>- 20]</code></pre></li>
</ul>
<p><strong>3 - Get the status of the nodes</strong></p>
<ul class="list">
<li><p>Are they turned on or off?</p>
<pre class="hljs"><code>  $ <span class="hljs-keyword">st</span></code></pre><p>Note : It is also possible to run this command directly without making a nodes selection (same for all upcoming commands)</p>
<pre class="hljs"><code>  $ <span class="hljs-keyword">st</span> <span class="hljs-number">15</span> <span class="hljs-number">25</span></code></pre></li>
<li><p>Which nodes are turned on?</p>
<pre class="hljs"><code>  $ show-nodes-<span class="hljs-function_start"><span class="hljs-keyword">on</span></span></code></pre></li>
<li><p>Do they answer to a ping command?</p>
<pre class="hljs"><code>  $ <span class="hljs-built_in">wait</span></code></pre></li>
<li><p>What is their current Linux version?</p>
<pre class="hljs"><code>  <span class="hljs-variable">$ </span>rel</code></pre></li>
</ul>
<p><strong>4 - Start / stop / reset the nodes</strong> </p>
<pre class="hljs"><code>  $ <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> [off/reset]</code></pre><p><strong>5 - Load an image in the selected nodes</strong>    </p>
<ul class="list">
<li><p>Ubuntu 14.10</p>
<pre class="hljs"><code>  <span class="hljs-variable">$ </span>load-u141<span class="hljs-number">0</span></code></pre></li>
<li><p>Ubuntu 15.04</p>
<pre class="hljs"><code>  <span class="hljs-variable">$ </span>load-u1504</code></pre></li>
<li><p>Fedora 21</p>
<pre class="hljs"><code>  $ load<span class="hljs-operator">-f</span>21</code></pre></li>
<li><p>Ubuntu 14.10 with gnuradio installed</p>
<pre class="hljs"><code>  <span class="hljs-variable">$ </span>load-gr-u141<span class="hljs-number">0</span></code></pre></li>
<li><p>Ubuntu 15.04 with gnuradio installed</p>
<pre class="hljs"><code>  <span class="hljs-variable">$ </span>load-gr-u1504</code></pre></li>
<li><p>Another image</p>
<pre class="hljs"><code>  $ load-image <span class="hljs-tag">&lt;<span class="hljs-title">myImage</span>&gt;</span></code></pre></li>
</ul>
<p><strong>6 - Run an ssh command on all selected nodes</strong></p>
<pre class="hljs"><code>    $ <span class="hljs-stl_container"><span class="hljs-built_in">map</span> &lt;mycommand&gt;</span></code></pre><p><strong>7 - Find other short commands</strong></p>
<pre class="hljs"><code>    $ <span class="hljs-built_in">help</span></code></pre><h1 id="access-with-nepi"><a class="header-link" href="#access-with-nepi"></a>Access with NEPI</h1>
<p>Use one of the scripts below</p>
<ul class="list">
<li><img src="./r2lab_testbed_bootstrap.py" alt="r2lab_testbed_bootstrap.py" title="r2lab_testbed_bootstrap.py"></li>
</ul>
<p>This is a maintenance script used to bootstrap the nodes from
INRIA testbed (R2Lab) before running an experiment using Nitos nodes.<br>This script loads an image into the nodes (image name can be changed at l. 84)
then resets the nodes, starts the wlan interface without configuring it.</p>
<p>Example of how to run this experiment (replace with your information):</p>
<pre class="hljs"><code>$ cd &lt;path-to-nepi&gt;/examples/linux [where the script has been copied]
$ python r2lab_testbed_bootstrap<span class="hljs-class">.py</span> -H &lt;fitXX,fitZZ,..&gt; -U &lt;r2lab-node-username&gt; -<span class="hljs-tag">i</span> &lt;ssh-key&gt; -g &lt;r2lab-gateway&gt; -u &lt;r2lab-slicename&gt;
$ python r2lab_testbed_bootstrap<span class="hljs-class">.py</span> -H fit12,fit18 -U root -<span class="hljs-tag">i</span> ~/<span class="hljs-class">.ssh</span> -g faraday<span class="hljs-class">.inria</span><span class="hljs-class">.fr</span> -u root</code></pre><ul class="list">
<li><img src="./r2lab_testbed_reset_eth.py" alt="r2lab_testbed_reset_eth.py" title="r2lab_testbed_reset_eth.py"></li>
</ul>
<p>This is a maintenance script used to reset the nodes from
INRIA testbed (R2Lab) before running a OMF experiment using Nitos nodes.<br>This script restarts the nodes, then starts the wlan interface without configuring it.</p>
<p>Example of how to run this experiment (replace with your information):</p>
<pre class="hljs"><code>$ cd &lt;path-to-nepi&gt;/examples/linux [where the script has been copied]
$ python r2lab_testbed_reset_eth<span class="hljs-class">.py</span> -H &lt;fitXX,fitZZ,..&gt; -U &lt;r2lab-node-username&gt; -<span class="hljs-tag">i</span> &lt;ssh-key&gt; -g &lt;r2lab-gateway&gt; -u &lt;r2lab-slicename&gt;
$ python r2lab_testbed_reset_eth<span class="hljs-class">.py</span> -H fit12,fit18 -U root -<span class="hljs-tag">i</span> ~/<span class="hljs-class">.ssh</span> -g faraday<span class="hljs-class">.inria</span><span class="hljs-class">.fr</span>  -u root</code></pre><ul class="list">
<li><img src="./r2lab_testbed_reset_wlan.py" alt="r2lab_testbed_reset_wlan.py" title="r2lab_testbed_reset_wlan.py"></li>
</ul>
<p>This is a maintenance script used to prepare the nodes from INRIA 
testbed (R2Lab) before running an OMF experiment using Nitos nodes with WiFi.<br>This script restarts the nodes, then starts and configures their 
WLAN interface (ad-hoc mode). IP address, ESSID and channel can be changed at line 118.</p>
<p>Example of how to run this experiment (replace with your information):</p>
<pre class="hljs"><code>$ cd &lt;path-to-nepi&gt;/examples/linux [where the script has been copied]
$ python r2lab_testbed_reset_wlan<span class="hljs-class">.py</span> -H &lt;fitXX,fitZZ,..&gt; -U &lt;r2lab-node-username&gt; -<span class="hljs-tag">i</span> &lt;ssh-key&gt; -g &lt;r2lab-gateway&gt; -u &lt;r2lab-slicename&gt;
$ python r2lab_testbed_reset_wlan<span class="hljs-class">.py</span> -H fit12,fit18 -U root -<span class="hljs-tag">i</span> ~/<span class="hljs-class">.ssh</span> -g faraday<span class="hljs-class">.inria</span><span class="hljs-class">.fr</span>  -u root</code></pre><ul class="list">
<li><p class="img-container"><img src="./r2lab_testbed_wlping.py" alt="r2lab_testbed_wlping.py" title="r2lab_testbed_wlping.py"></p>
<p>  Testbed : R2LAB   </p>
<pre class="hljs"><code>  Node fitXX    
       <span class="hljs-number">0</span>   
       <span class="hljs-string">|   </span>
       <span class="hljs-number">0</span>   
  Node fitYY   </code></pre><p>  PING OVER WI-FI   </p>
<ul class="list">
<li>Experiment:  <ul class="list">
<li>t0 : Deployment and configuration   </li>
<li>t1 : Ping Start (3 packets sent over the air)  </li>
<li>t2 : Kill the application and retrieve traces  </li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Example of how to run this experiment (replace with your information):</p>
<pre class="hljs"><code>$ cd &lt;path-to-nepi&gt;/examples/linux [where the script has been copied]
$ python r2lab_testbed_wlping<span class="hljs-class">.py</span> -x &lt;fitXX&gt; -y &lt;fitYY&gt; -c &lt;channel&gt; -e &lt;essid&gt; -u &lt;r2lab-slicename&gt; -<span class="hljs-tag">i</span> &lt;ssh-key&gt; -g &lt;r2lab-gateway&gt; -U &lt;r2lab-node-username&gt;
$ python r2lab_testbed_wlping<span class="hljs-class">.py</span> -x fit12 -y fit18 -c <span class="hljs-number">03</span> -e fitessai -u root -<span class="hljs-tag">i</span> ~/<span class="hljs-class">.ssh</span> -g faraday<span class="hljs-class">.inria</span><span class="hljs-class">.fr</span> -U root</code></pre><h1 id="x11-access-to-be-confirmed-"><a class="header-link" href="#x11-access-to-be-confirmed-"></a>X11 Access (to be confirmed)</h1>
<p> 1 - Install <code>xterm</code>  on the target node (e.g., fit25)</p>
<pre class="hljs"><code>$ apt-<span class="hljs-built_in">get</span> <span class="hljs-keyword">update</span>
$ apt-<span class="hljs-built_in">get</span> install xterm   </code></pre><p> 2 - Connect to faraday from your user host with the &quot;-X&quot; option</p>
<pre class="hljs"><code>$ ssh -X my-account@faraday<span class="hljs-class">.inria</span><span class="hljs-class">.fr</span></code></pre><p> 3 - Hop to the Nitos node with the &quot;-X&quot; option</p>
<pre class="hljs"><code><span class="hljs-variable">$ </span>ssh -<span class="hljs-constant">X </span>fit25</code></pre><p> 4 - Launch <code>xterm</code> to obtain the graphic display of the node</p>
<pre class="hljs"><code><span class="hljs-variable">$ </span>xterm</code></pre>  </div>

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
</body>
</html>
